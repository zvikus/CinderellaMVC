<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head th:insert="blocks/admin/adminHead :: adminHead">

</head>

<body>

<div class="container py-3">
    <header th:insert="blocks/header :: header">

    </header>

    <main>
        <h1>РЕДАКТИРОВАТЬ</h1>

        <div class="bd-example">
            <form action="/admin/editUser" method="post" class="needs-validation"  enctype="multipart/form-data">
            <!--            <ul class="list-unstyled">-->
            <input
                    type="hidden"
                    th:name="id"
                    th:value="${user.id}" />
<!--            <input-->
<!--                    type="hidden"-->
<!--                    th:name="registrationDate"-->
<!--                    th:value="${user.registrationDate}" />-->
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="username">
                        Имя пользователя
                    </label>
                    <input th:value="${user.username}"  type="text" id="username" name="username" placeholder="Название" class="form-control mt-2" required>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="active">
                        Активация
                    </label>
                    <input id="active" type="checkbox" name="active" th:checked="${user.active}" />
                </div>
                <div class="col-md-3 mb-3">
                    <label for="active">
                        Про аккаунт
                    </label>
                    <input id="proAccount" type="checkbox" name="proAccount" th:checked="${user.proAccount}" />
                </div>
            </div>
            <div class="mb-3">
                <label for="email">
                    Email
                </label>
                <input th:value="${user.email}"  type="email" id="email" name="email" placeholder="Адрес" class="form-control mt-2" required>
            </div>
            <div class="mb-3">
                <label for="email">
                    Код активации
                </label>
                <input th:value="${user.activationCode}" type="activationCode" id="activationCode" name="activationCode" class="form-control mt-2">
            </div>

            <div class="mb-3">
                <label for="registrationDate">
                    Дата регистрации
                </label>
                <div id="registrationDate" th:text="${#calendars.format(user.registrationDate, 'dd/MMM/yyyy HH:mm')}"/>
            </div>
            <div class="mb-3">
                <label for="activationDate">
                    Дата активации
                </label>
                <div id="activationDate" th:text="${#calendars.format(user.activationDate, 'dd/MMM/yyyy HH:mm')}"/>
            </div>

            <div class="mb-3">
                <ul class="list-unstyled categories-list">
                    <li th:each="feat : ${userRoles}" class="custom-control custom-checkbox categories-list-item mb-2">
                        <input type="checkbox" name="roles" class="custom-control-input"
                               th:id="${feat}"
                               th:value="${feat}"
                               th:field="*{user.roles}"
                        />
                        <label class="custom-control-label"
                               th:for="${feat}"
                               th:text="${feat}"
                        />
                    </li>
                </ul>
            </div>
            <input
                    type="hidden"
                    th:name="${_csrf.parameterName}"
                    th:value="${_csrf.token}" />

            <div class="row mb-3">
                <div class="col-md-4">
                    <button type="submit" class="btn btn btn-outline-primary regular-button mt-5 left">Сохранить</button>
                </div>
            </div>
        </form>
        </div>
        <div class="bd-example">
            <div class="mb-3">
                    <div class="row">
                        <h4>Подключенные услуги:</h4>
                    </div>
                    <div class="row" th:each="restriction : ${user.restrictions}">
                        <span class="col-md-2" >
                            <strong th:text="${restriction.service.name}"></strong>
                        </span>
                        <span class="col-md-2" ><u>Дата покупки:</u></span>
                        <span class="col-md-2" th:text="${#calendars.format(restriction.activationDate, 'dd/MMM/yyyy HH:mm')}"></span>
                        <span class="col-md-2" ><u>Дата окончания действия:</u></span>
                        <span class="col-md-2" th:text="${#calendars.format(restriction.expirationDate, 'dd/MMM/yyyy HH:mm')}"></span>
                        <span class="col-md-2">
                            <a th:href="@{/admin/restriction/} + ${restriction.id} + @{/} + ${user.id} + @{/remove}">Удалить</a>
                        </span>
                    </div>
            </div>
            <div class="mb-3">
                <button class="btn btn-outline-primary regular-button" type="button" data-toggle="collapse" data-target="#addRestriction" aria-expanded="false" aria-controls="addRestriction">
                    Добавить услугу
                </button>
            </div>
            <div class="mb-3">
                <div class="collapse" name="username" id="addRestriction" style="user.id">
                    <form action="/admin/addRestriction" method="post" class="needs-validation"  enctype="multipart/form-data">
                        <input type="hidden" th:value="${user.id}" name="userId">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="service">
                                    Сервис
                                </label>
                                <select name="service" id="service" class="custom-select d-block w-100">
                                    <option th:each="service : ${services}"
                                            th:value="${service.id}" th:text="${service.name}"></option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="term">
                                    Срок
                                </label>
                                <select name="term" id="term" class="custom-select d-block w-100">
                                    <option value="1">1 месяц</option>
                                    <option value="2">2 месяца</option>
                                    <option value="3">3 месяца</option>
                                    <option value="6">6 месяцев</option>
                                    <option value="12">1 год</option>
                                    <option value="24">2 года</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <input
                                        type="hidden"
                                        th:name="${_csrf.parameterName}"
                                        th:value="${_csrf.token}" />
                                <button type="submit" class="btn btn btn-outline-primary regular-button mt-4 left">Добавить</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <footer th:insert="blocks/footer :: footer" class="text-muted mt-5">

    </footer>
</div>





</body>










</html>